FHA 功能危害性分析 (Functional Hazard Analysis) 工具
简介
本工具是一个基于 Python 和 PySide6 开发的桌面应用程序，旨在为航空航天、汽车等领域的系统安全工程师提供一个轻量级、高效的功能危害性分析（FHA）报告撰写与管理平台。

它允许用户创建、编辑、保存和查询FHA表格，支持从Excel文件导入和导出数据，并提供一个智能分级查询系统，帮助工程师快速定位和分析特定功能层级下的失效模式和影响。

主要功能
FHA报告管理:

新建报告: 创建一个符合ARP4761标准的空白FHA表格。

加载数据: 从现有的Excel文件 (.xlsx, .xls) 导入FHA数据，并自动填充到表格中。

导出报告: 将当前表格中的所有数据导出为格式化的Excel文件，便于归档和分享。

实时编辑: 直接在表格中对任意单元格进行编辑，所见即所得。

行操作: 轻松添加新行或删除指定行。

智能分级查询:

三级联动筛选: 提供“一级功能”、“二级功能”、“三级功能”的层级下拉框。

动态更新: 当您选择一个父级功能后，子级功能的下拉选项会自动更新，只显示相关的条目。

精确查询: 根据选择的功能组合，实时筛选并展示相关的FHA条目及其详细信息。

用户体验:

清晰的界面布局: 使用标签页将报告编辑和智能查询功能清晰地分离开来。

悬停提示: 当鼠标悬停在表格单元格上时，会自动显示该单元格的完整内容，解决了内容过长无法完全显示的问题。

依赖一键安装: 提供独立的依赖安装脚本，简化环境配置过程。

项目架构
本项目采用了模型-视图-控制器 (MVC) 的设计思想，将界面、逻辑和数据清晰分离，使得代码易于维护和扩展。

模型 (Model): fha_model.py

作为应用的核心后端，负责所有数据处理逻辑。

它使用 pandas 库来管理FHA数据，并提供加载、保存、增、删、改、查等所有与数据相关的接口。

此文件完全独立于用户界面，可以单独进行测试。

视图 (View): fha_main_app.py

作为应用的主窗口和用户界面层。

使用 PySide6 构建所有窗口、按钮、表格和下拉框。

负责展示数据给用户，并捕获用户的操作（如点击、选择等）。

控制器/适配器 (Controller/Adapter):

主控制器: fha_main_app.py 中的各个槽函数（如 load_file, delete_row 等）充当控制器，响应用户操作，调用模型的方法来更新数据，并刷新视图。

数据适配器: pandas_model.py 作为一个桥梁，将 pandas.DataFrame 格式的数据适配成 PySide6 的 QTableView 能够理解和展示的标准模型。
如何运行
1. 前提条件
确保您的电脑上已经安装了 Python 3。

2. 安装依赖
首先，运行依赖安装脚本来自动安装所有必需的软件包。打开命令行（CMD 或 PowerShell），进入项目所在文件夹，然后运行：

python install_qt_requirements.py
该脚本会自动安装 pandas, openpyxl, 和 PySide6。

3. 启动主程序
依赖安装成功后，运行主程序来启动应用：

python fha_main_app.py
程序启动后，您将看到FHA工具的主界面。

文件说明
install_qt_requirements.py: 依赖安装脚本。运行此文件来为应用准备好运行环境。

fha_main_app.py: 主应用入口与UI界面。包含了所有界面元素和用户交互逻辑。

fha_model.py: 核心数据模型。处理所有FHA数据的后端逻辑。

pandas_model.py: Pandas-Qt适配器。用于在Qt表格中高效地显示和编辑Pandas数据。
